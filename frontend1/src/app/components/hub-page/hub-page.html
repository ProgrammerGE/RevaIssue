<div class="hub-page">
  <app-nav-bar></app-nav-bar>
  @if(isSearchPopupActive()){
  <app-popup-wrapper>
    <div class="overlay" (click)="closePopup()"></div>
    <div class="search-popup">
      <button class="close-popup-btn" (click)="closePopup()">
        <img src="/assets/icons/x.svg" />
      </button>
      <input class="search-input" type="text" placeholder="Search for issues" (input)="searchInput($event)" />
      @for(issue of searchResults(); track $index){
      <a class="search-result-item" [routerLink]="['/projects', issue.project?.projectID]">
        {{issue.name}}
      </a>
      }
    </div>
  </app-popup-wrapper>
  }
  <div class="popup">
    <app-create-project></app-create-project>
  </div>
  <header class="hub-header">
    <div>
      <h2 class="welcome-message">Welcome, {{ username() | capitalizeFirst }}</h2>
      <span>{{ userRole() }}</span>
    </div>
    <app-search-bar [(active)]="isSearchPopupActive"></app-search-bar>
  </header>
  <section class="lists">
    <app-list-container
      title="Projects"
      [items]="projectsList()"
      [hasButton]="true"
      [itemClicked]="goToProject"
      [userRole] = "userRole()"
    >
    </app-list-container>
    <app-list-container
      title="Recent Issues"
      [items]="issuesList()"
      [hasButton]="false"
    ></app-list-container>
  </section>
  @if(isAdmin()){
  <section class="audit-logs">
    <h4 style="margin-left: 10px">Audit Logs</h4>
    @for (item of auditLogs(); track $index) {
    {{ item.role }}: {{ item.username }} {{ item.action }} at {{ item.timeLogged }} <br />
    }
  </section>
  }
</div>