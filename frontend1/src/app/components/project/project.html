<app-nav-bar></app-nav-bar>

<div class="parent">

  <!-- title -->
  <div class="div1">
    <!-- This will contain an element that reflects the name of the project entity -->
    <h3>{{ projectTitle() }}</h3>
  </div>
  <!-- description -->
  <div class="div2">
    <!-- This will contain an element that says something like "Description:". This could be removed -->
    <!-- <h4>Description:</h4> -->
    <p>{{ projectDescription() }}</p>
  </div>
  <!-- users display -->
  <div class="div3">
    <h2>Users List</h2>
    <!-- Show button/form for adding and removing users -->
    @if (userRole === 'admin') {
      <button (click)="addUserToProject()">Add User</button>
      <input type="text" [ngModel]="newUser()" (ngModelChange)="newUser.set($event)" placeholder="Enter username" />
    }
    <!-- Show the user list -->
    <div id="project-user-list">
      @for (user of users(); track user.username; let i = $index) {
      <div class="user-item" [class.is-admin]="userRole === 'admin'"
        (click)="userRole === 'admin' ? onUserClick(user) : null">
        <strong>{{ user.username }} {{user.role}}</strong>
      </div>
      } @empty {
      <p>No users found or still loading...</p>
      }
    </div>
  </div>
  <!-- issue selector pane -->
  <div class="div4">
      <!--First is the issues browser pane. It shows the projects issues. Users can click on them
              to be taken to a page where they can view that issue's details. Testers have a button
              to create issues. -->
      <div class="issues-header">
        <h4>Project Issues</h4>
        @if (userRole === 'tester') {
        <button class="btn-create">Create Issue</button>
        }
      </div>

      <div class="issues-list">
        @for (issue of issues(); track issue.id) {
        <div class="issue-card" (mouseenter)="hoveredIssue = issue">
          <span class="issue-id">#{{ issue.id }}</span>
          <span class="issue-title">{{ issue.title }}</span>
          <span class="issue-priority" [attr.data-priority]="issue.priority">
            {{ issue.priority }}
          </span>
        </div>
        }
      </div>
  </div>
  <!-- issue viewing pane -->
  <div class="div5">

      <!--Second is the quick description pane. It shows the description of the issue that
          is currently being hovered over
          TODO: First add the issues table, then add the issue quick description.
          Make the issues table & quick description child components of project-->
      <div class="description-box">
        <h4>Quick Preview</h4>
        <hr>
        @if (hoveredIssue) {
        <p class="fade-in">{{ hoveredIssue.description }}</p>
        } @else {
        <p class="placeholder-text">Hover over an issue to see details...</p>
        }
      </div>

  </div>
</div>
